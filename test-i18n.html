<!DOCTYPE html>
<html>
<head>
    <title>Test i18n</title>
    <script src="http://localhost:1880/vendor/jquery/jquery-1.11.1.min.js"></script>
    <script src="http://localhost:1880/red/red.min.js"></script>
</head>
<body>
    <h1>Test Node-RED i18n</h1>
    
    <h2>Make IoT Smart Node Help</h2>
    <div id="make-iot-smart-help">
        <p data-i18n="make-iot-smart.help.description">Loading...</p>
        <h3 data-i18n="common.label.details">Loading...</h3>
        <p data-i18n="make-iot-smart.help.details.overview">Loading...</p>
    </div>
    
    <h2>API Config Node Help</h2>
    <div id="api-config-help">
        <p data-i18n="api-config.help.description">Loading...</p>
        <h3 data-i18n="common.label.details">Loading...</h3>
        <p data-i18n="api-config.help.details.overview">Loading...</p>
    </div>
    
    <script>
        $(document).ready(function() {
            console.log('Testing i18n...');
            
            // 尝试加载国际化资源
            $.getJSON('/locales/@jimmyfreecoding/node-red-make-iot-smart/make-iot-smart', function(data) {
                console.log('Locales loaded:', data);
                
                // 手动替换文本
                $('[data-i18n]').each(function() {
                    var key = $(this).attr('data-i18n');
                    var keys = key.split('.');
                    var value = data;
                    
                    for (var i = 0; i < keys.length; i++) {
                        if (value && value[keys[i]]) {
                            value = value[keys[i]];
                        } else {
                            value = 'Missing: ' + key;
                            break;
                        }
                    }
                    
                    $(this).text(value);
                });
            }).fail(function() {
                console.error('Failed to load locales');
                $('[data-i18n]').text('Failed to load locales');
            });
        });
    </script>
</body>
</html>